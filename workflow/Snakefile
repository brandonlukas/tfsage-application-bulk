configfile: "config/config.yaml"


with open(config["factor_list"]) as f:
    factor_list = [line.strip() for line in f.readlines()]

with open(config["query_set"]) as f:
    query_set = [line.strip() for line in f.readlines()]


include: "rules/prepare_data.smk"
include: "rules/generate.smk"
include: "rules/motif_scan.smk"
include: "rules/network.smk"


rule all:
    input:
        # expand(
        #     config["results_dir"]
        #     + "generate/all/{threshold}/tfsage_experiments/head_{n}/{query_id}_{factor}.parquet",
        #     threshold=config["thresholds"],
        #     n=config["tfsage_n"],
        #     query_id=query_set,
        #     factor=factor_list,
        # ),
        # config["results_dir"] + "generate/exclude_holdout/benchmark_metrics.csv",
        expand(
            config["results_dir"]
            + "network/{threshold}/networks/tfsage/{mode}/head_{n}/{query_id}.parquet",
            threshold=config["thresholds"],
            n=config["tfsage_n"],
            query_id=query_set,
            mode=["all", "exclude_holdout"],
        ),
        expand(
            config["results_dir"]
            + "network/{threshold}/networks/motif_scan/{motif_db}/{query_id}.parquet",
            threshold=config["thresholds"],
            query_id=query_set,
            motif_db=config["motif_dbs"],
        ),
